# Gitleaks Configuration for Pathfinder Project
# This file configures gitleaks to detect secrets specific to our tech stack

title = "Pathfinder Project Security Config"

[extend]
# Use the default gitleaks rules as a base
useDefault = true

[[rules]]
description = "Auth0 Client ID"
id = "auth0-client-id"
regex = '''(?i)(auth0[_-]?client[_-]?id[_-]?[=:]\s*["']?)([a-zA-Z0-9]{32})'''
tags = ["auth0", "client-id"]

[[rules]]
description = "Auth0 Client Secret"
id = "auth0-client-secret"
regex = '''(?i)(auth0[_-]?client[_-]?secret[_-]?[=:]\s*["']?)([a-zA-Z0-9_-]{64})'''
tags = ["auth0", "client-secret", "secret"]

[[rules]]
description = "Auth0 Domain"
id = "auth0-domain"
regex = '''(?i)(auth0[_-]?domain[_-]?[=:]\s*["']?)([a-zA-Z0-9-]+\.auth0\.com)'''
tags = ["auth0", "domain"]

[[rules]]
description = "OpenAI API Key"
id = "openai-api-key"
regex = '''sk-[a-zA-Z0-9]{48}'''
tags = ["openai", "api-key", "secret"]

[[rules]]
description = "Azure Subscription ID"
id = "azure-subscription-id"
regex = '''[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'''
tags = ["azure", "subscription"]

[[rules]]
description = "Google Maps API Key"
id = "google-maps-api-key"
regex = '''AIza[0-9A-Za-z_-]{35}'''
tags = ["google", "maps", "api-key"]

[[rules]]
description = "Cosmos DB Key"
id = "cosmos-db-key"
regex = '''(?i)(cosmos[_-]?db[_-]?key[_-]?[=:]\s*["']?)([a-zA-Z0-9+/=]{88,})'''
tags = ["cosmos", "database", "secret"]

[[rules]]
description = "Azure Container Apps URL"
id = "azure-container-apps-url"
regex = '''https://[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+\.azurecontainerapps\.io'''
tags = ["azure", "container-apps", "url"]

[[rules]]
description = "Database Connection String"
id = "database-connection-string"
regex = '''(?i)(database[_-]?url[_-]?[=:]\s*["']?)(postgresql|mysql|mongodb|sqlite)://[^\s"']+'''
tags = ["database", "connection-string"]

[[rules]]
description = "Redis Connection String"
id = "redis-connection-string"
regex = '''(?i)(redis[_-]?url[_-]?[=:]\s*["']?)redis://[^\s"']+'''
tags = ["redis", "connection-string"]

[[rules]]
description = "SMTP Password"
id = "smtp-password"
regex = '''(?i)(smtp[_-]?password[_-]?[=:]\s*["']?)([a-zA-Z0-9!@#$%^&*()_+-=]{8,})'''
tags = ["smtp", "password", "email"]

[[rules]]
description = "JWT Secret"
id = "jwt-secret"
regex = '''(?i)(jwt[_-]?secret[_-]?[=:]\s*["']?)([a-zA-Z0-9!@#$%^&*()_+-=]{32,})'''
tags = ["jwt", "secret"]

# Allowlist for test files and templates
[allowlist]
description = "Allowlist for test files and templates"
files = [
    '''.*test.*\.py''',
    '''.*test.*\.js''',
    '''.*test.*\.ts''',
    '''.*\.template$''',
    '''.*\.example$''',
    '''.*\.sample$''',
    '''SECURITY_SCAN_REPORT\.md''',
    '''security-remediation\.sh''',
    '''.*\.md$'''  # Allow markdown files (documentation)
]

paths = [
    '''gitleaks-report\.json''',
    '''.*venv/.*''',
    '''.*node_modules/.*''',
    '''.*\.git/.*''',
    '''backend/venv/.*''',
    '''frontend/node_modules/.*'''
]

# Specific patterns to ignore
regexes = [
    '''example\.com''',
    '''test@example\.com''',
    '''your-.*''',
    '''dummy-.*''',
    '''placeholder''',
    '''dev-.*-placeholder''',
    '''sk-dev-.*''',
    '''C2y6yDjf5/R\+ob0N8A7Cgv30VRDJIWEHLM\+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw=='''  # Cosmos DB emulator key
]
